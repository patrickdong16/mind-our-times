# Mind Our Times — 需求规格书

> **版本**：v1.0  
> **日期**：2026-02-04  
> **状态**：草稿，待 DQ 确认  
> **规则**：所有需求变更必须先更新本文件

---

## 一、产品定义

### 1.1 一句话

**Mind Our Times** 是一个由 AI 驱动的时代思想观测站 — 每日追踪全球顶级思想者的观点，监测社会共识与时代情绪的微妙变化。

### 1.2 核心价值

| 层面 | 回答什么 |
|------|----------|
| **内容** | 今天最重要的思想碰撞是什么？ |
| **投票** | 社会共识正在往哪个方向漂移？ |
| **长期** | 哪些结构正在断裂、哪些价值正在被重估？ |

### 1.3 目标用户

- **核心用户**：DQ 及其投资圈子（高认知密度、关注长期趋势）
- **扩展用户**：关注时代议题的知识分子、媒体人、学者
- **访问方式**：完全公开，无需登录

### 1.4 产品不是什么

- ❌ 不是新闻聚合器（不追热点，追结构性问题）
- ❌ 不是社交平台（不做 feed 流、不做关注/粉丝）
- ❌ 不是内容管理系统（没有 CMS，Pepper 是唯一编辑）

---

## 二、系统架构

### 2.1 三层结构

```
┌──────────────────────────────────────────────┐
│  内容引擎 (Pepper, Mac mini)                  │
│  • 思想雷达 cron 每日生成                      │
│  • 10 篇短分析 + 1 篇综述 + 1 个投票问题       │
│  • 通过 API 写入 CloudBase                    │
└──────────────────┬───────────────────────────┘
                   ▼
┌──────────────────────────────────────────────┐
│  数据层 (腾讯云 CloudBase)                     │
│  • 云数据库：文章 + 投票 + 领域配置             │
│  • 云函数：读写 API（4-5 个函数）              │
└──────────────────┬───────────────────────────┘
                   ▼
┌──────────────────────────────────────────────┐
│  展示层                                       │
│  ┌─────────────────┬────────────────────────┐ │
│  │ Webapp          │ 公众号                  │ │
│  │ 今日 + 往期     │ 日度综述 + H5 投票      │ │
│  │ 领域标签筛选    │ 社交分发 + 引流 webapp  │ │
│  │ 评论 (Twikoo)   │ 微信原生分享            │ │
│  └─────────────────┴────────────────────────┘ │
└──────────────────────────────────────────────┘
```

### 2.2 技术选型

| 组件 | 技术 | 理由 |
|------|------|------|
| 内容引擎 | Python (Pepper 脚本) | 已有成熟的 RSS 抓取 + AI 分析管线 |
| 数据库 | CloudBase 云数据库 | 国内访问快，免费额度够用 |
| API | CloudBase 云函数 (Node.js) | 与数据库同平台，零网络延迟 |
| Webapp 前端 | 纯静态 HTML/CSS/JS | 无框架，轻量快速，移动端优先 |
| Webapp 托管 | CloudBase 静态托管（生产）+ Vercel（测试） | 国内可访问 |
| 评论系统 | Twikoo（基于 CloudBase） | 开源免费，零登录，自带反垃圾 |
| 公众号 | 微信公众号 API | 草稿自动生成，人工审核发布 |
| H5 投票 | CloudBase 云函数 + 静态页 | 嵌入公众号，数据自有 |

### 2.3 部署策略

| 环境 | 平台 | 用途 |
|------|------|------|
| 生产 | 腾讯云 CloudBase | 面向国内用户 |
| 测试/预览 | Vercel | DQ 和 Pepper 验收 |

---

## 三、领域系统

### 3.1 设计原则

- **只有一层领域标签**，无子频段
- **配置驱动**：领域定义存在数据库中，可随时增减
- 每个领域附带一个核心张力问题（用于投票系统的内核锚定）

### 3.2 初始领域（6 个）

| 标识 | 领域 | 核心问题 | 是 | 否 |
|------|------|----------|-----|-----|
| T | 技术 | AI 是否正在加剧社会分层？ | 正在加剧 | 趋向普惠 |
| P | 政治 | 民主制度是否正在失效？ | 正在失效 | 仍然有效 |
| H | 历史 | 当前文明是否正在走向衰退？ | 正在衰退 | 只是调整 |
| Φ | 哲学 | 算法优化是否正在侵蚀自由意志？ | 正在侵蚀 | 只是工具 |
| R | 宗教 | 科技是否正在成为新宗教？ | 正在替代 | 只是工具 |
| F | 金融 | 金融是否正在加剧社会撕裂？ | 正在加剧 | 可以修复 |

### 3.3 扩展规则

- 后续可增加领域（如艺术/文学），只需在配置中添加
- 每个领域必须有：标识符、中文名、核心问题、是/否标签
- 标识符全局唯一，一旦创建不可修改（历史数据依赖）

---

## 四、内容模型

### 4.1 短分析（daily_articles）

每日 10 篇，面向 webapp 展示。

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | 自动 | 唯一标识 |
| date | string | ✅ | 发布日期 YYYY-MM-DD |
| domain | string | ✅ | 领域标识（T/P/H/Φ/R/F） |
| title | string | ✅ | 标题（中文） |
| author_name | string | ✅ | 原作者真实姓名 |
| author_intro | string | ✅ | 作者一句话介绍 |
| source | string | ✅ | 来源（媒体/会议 + 日期） |
| source_url | string | ✅ | 原文链接（必须真实可访问） |
| content | string | ✅ | 分析正文（300-400 字） |
| insight | string | ✅ | 💭 题外话（时代潜台词洞察，1-2 句） |
| created_at | timestamp | 自动 | 写入时间 |

### 4.2 日度综述（daily_digest）

每日 1 篇，面向公众号发布。

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | 自动 | 唯一标识 |
| date | string | ✅ | 日期 YYYY-MM-DD |
| title | string | ✅ | 综述标题 |
| content | string | ✅ | 综述正文（1500-2500 字） |
| vote_question | string | ✅ | 今日投票问题（灵活措辞） |
| vote_domain | string | ✅ | 映射到哪个领域的核心问题 |
| vote_yes_label | string | ✅ | 「是」的具体表述 |
| vote_no_label | string | ✅ | 「否」的具体表述 |
| article_ids | array | ✅ | 引用了哪些短分析 |
| wechat_status | string | 自动 | draft / published |
| created_at | timestamp | 自动 | 写入时间 |

### 4.3 投票记录（votes）

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | 自动 | 唯一标识 |
| digest_id | string | ✅ | 关联的综述 |
| domain | string | ✅ | 领域标识 |
| vote | string | ✅ | "yes" 或 "no" |
| voter_id | string | 自动 | 匿名标识（浏览器指纹或 openid） |
| created_at | timestamp | 自动 | 投票时间 |

### 4.4 领域配置（domains）

| 字段 | 类型 | 说明 |
|------|------|------|
| id | string | 领域标识（T/P/H/Φ/R/F） |
| name | string | 中文名 |
| core_question | string | 核心问题 |
| yes_label | string | 是方标签 |
| no_label | string | 否方标签 |
| sort_order | number | 显示排序 |
| active | boolean | 是否启用 |

---

## 五、Webapp 需求

### 5.1 页面结构

**只有两个 Tab：今日 | 往期**

#### 今日页

```
┌─────────────────────────────────┐
│  Mind Our Times                 │
│  [今日]  [往期]                  │
├─────────────────────────────────┤
│  2026年2月4日 · 星期二           │
│                                 │
│  [全部] [技术] [政治] [...] [金融]│  ← 领域标签筛选
│                                 │
│  ┌─────────────────────────────┐│
│  │ ▍技术                       ││
│  │ GPT-5 定价策略的阶层含义     ││
│  │ Sam Altman · OpenAI CEO     ││
│  │                             ││
│  │ 正文 300-400 字...          ││
│  │                             ││
│  │ 💭 题外话：...              ││
│  │                             ││
│  │ 原文 → [链接]      2月3日   ││
│  └─────────────────────────────┘│
│                                 │
│  ┌─────────────────────────────┐│
│  │ ▍政治                       ││
│  │ ...                         ││
│  └─────────────────────────────┘│
│                                 │
│  ... (共 10 篇)                 │
│                                 │
│  ── 评论区 (Twikoo) ──         │
└─────────────────────────────────┘
```

#### 往期页

```
┌─────────────────────────────────┐
│  Mind Our Times                 │
│  [今日]  [往期]                  │
├─────────────────────────────────┤
│                                 │
│  [全部] [技术] [政治] [...] [金融]│  ← 领域标签筛选（跨日期）
│                                 │
│  ▸ 2026年2月4日 (10篇)          │  ← 按日期折叠
│  ▾ 2026年2月3日 (8篇)           │
│    ┌───────────────────────────┐│
│    │ ▍技术                     ││
│    │ 标题...                   ││
│    │ 摘要第一句...             ││
│    └───────────────────────────┘│
│    ...                          │
│  ▸ 2026年2月2日 (10篇)          │
│  ...                            │
└─────────────────────────────────┘
```

### 5.2 设计原则

| 原则 | 要求 |
|------|------|
| **移动端优先** | 主要使用场景是手机浏览 |
| **阅读体验** | 纽约客/端传媒风格，衬线字体，大量留白 |
| **零框架** | 纯 HTML/CSS/JS，无 React/Vue，保证加载速度 |
| **暗色模式** | 支持系统级暗色模式切换 |
| **无需登录** | 所有内容公开可读 |
| **无翻页** | 今日页直接展示全部内容；往期页按日期懒加载 |

### 5.3 交互细节

- 领域标签筛选：点击领域标签过滤内容，支持多选/取消
- 今日页：卡片默认全部展开，内容完整可读
- 往期页：按日期分组，默认折叠，点击展开
- 原文链接：在新标签页打开
- 评论区：今日页底部，Twikoo 组件
- 无下拉刷新（不需要，每日更新一次）

### 5.4 功能边界（明确不做）

| 不做 | 理由 |
|------|------|
| 用户登录/注册 | 完全公开，无需身份 |
| 搜索 | MVP 不做，后续按需 |
| 收藏/点赞 | 无用户系统 |
| 分享按钮 | 主要分享渠道是公众号，webapp 不是分享入口 |
| 推送通知 | 公众号承担推送职责 |
| PDF 导出 | 不再生成 PDF |

---

## 六、公众号需求

### 6.1 发布流程

```
Pepper 生成综述 + 投票问题
    ↓
通过微信公众号 API 创建草稿
    ↓
DQ 人工审核
    ↓
DQ 确认发布（或 Pepper 代发，需 DQ 授权）
```

### 6.2 文章结构

```
┌─────────────────────────────────┐
│  [头图]                         │
│                                 │
│  Mind Our Times · 2月4日         │
│                                 │
│  综述正文                       │
│  1500-2500 字                   │
│  从当日 10 篇中提炼 2-3 个       │
│  最有张力的主题                  │
│                                 │
│  ─── 今日之问 ───               │
│                                 │
│  [嵌入 H5 投票组件]             │
│  "OpenAI GPT-5 定价 $200/月，   │
│   这是否在制造新的数字鸿沟？"    │
│                                 │
│  [正在加剧]  [趋向普惠]          │
│                                 │
│  已有 234 人参与投票              │
│  62% 认为正在加剧                │
│                                 │
│  ─────────────────              │
│  📖 查看今日全部 10 篇分析       │
│     → webapp 链接               │
│                                 │
│  关注「Mind Our Times」          │
│  每日推送 · 追踪时代思想脉搏     │
└─────────────────────────────────┘
```

### 6.3 H5 投票组件

- 嵌入公众号文章，指向 CloudBase 托管的投票页
- 投票后立即显示当前结果（实时统计）
- 每人每题限投一次（浏览器指纹 or 微信 openid）
- 数据写入 CloudBase 数据库 votes 表
- 投票结果可通过 API 查询（用于趋势分析）

### 6.4 自动生成规则

Pepper 每日综述的 AI prompt 要求：
- 从当天 10 篇短分析中选取 2-3 个最有张力的主题
- 编织成一篇连贯的分析文章，不是简单罗列
- 风格：知识分子随笔，有观点、有立场、有质疑
- 结尾提出一个与当天主题紧扣的投票问题
- 投票问题必须映射到某个领域的核心问题

---

## 七、投票与趋势系统

### 7.1 数据结构

每次投票记录三层信息：

```
核心问题 (domain)     ← 固定不变（T/P/H/Φ/R/F 的核心问题）
  └── 每日变体 (vote_question)  ← 灵活措辞，紧贴时事
        └── 用户投票 (yes/no)   ← 匿名采样
```

### 7.2 趋势分析能力

| 分析维度 | 说明 |
|----------|------|
| 单领域趋势 | T 领域过去 90 天的「加剧 vs 普惠」比例变化曲线 |
| 跨领域对比 | 六大领域的当前共识分裂度排名 |
| 事件冲击 | 重大事件前后的情绪突变检测 |
| 季度报告 | 可输出「时代情绪季报」作为公众号特刊素材 |

### 7.3 数据展示

- **公众号文章内**：投票后实时显示当前结果
- **Webapp**（Phase 2）：趋势图表页，展示历史数据
- **Pepper 分析**：定期生成趋势洞察，供 DQ 参考

---

## 八、内容引擎（Pepper 侧）

### 8.1 现有资产复用

| 资产 | 来源 | 用途 |
|------|------|------|
| RSS 源配置 | `CONTENT_SOURCES.json`（40+ 源） | 直接复用 |
| RSS 抓取 + AI 分析 | `daily-briefing.py` | 改造输出目标 |
| 频段/领域定义 | 旧 REQUIREMENTS.md | 简化为 6 领域 |
| 微信发布逻辑 | 旧 `wechat-publisher.js` | 参考重写 |

### 8.2 Pepper 每日工作流

```
06:00 CST — 思想雷达 cron 触发
  │
  ├── Step 1: RSS 抓取 + AI 分析
  │   └── 产出 10 篇短分析 (300-400 字/篇)
  │
  ├── Step 2: 写入 CloudBase (daily_articles)
  │
  ├── Step 3: 从 10 篇中生成综述 (1500-2500 字)
  │   └── 选取 2-3 个最有张力的主题
  │   └── 生成投票问题（映射领域核心问题）
  │
  ├── Step 4: 写入 CloudBase (daily_digest)
  │
  ├── Step 5: 创建微信公众号草稿
  │
  └── Step 6: Telegram 通知 DQ
      "今日思想雷达已更新，公众号草稿待审核"
```

### 8.3 Telegram 降级

- 不再发送完整内容到 Telegram
- 仅发一条通知消息：「今日更新已就绪 + webapp 链接 + 公众号待审核」
- DQ 在 Telegram 里点链接去 webapp 阅读

### 8.4 内容质量规则

| 规则 | 要求 |
|------|------|
| **零虚构** | 所有 source_url 必须真实可访问 |
| **真实作者** | author_name 必须是真实人物 |
| **领域覆盖** | 每日 10 篇尽量覆盖 6 大领域（不强制每个都有） |
| **来源多样** | 同一天同作者最多 1 篇 |
| **中文输出** | 标题和正文均为中文 |

---

## 九、API 端点

### 9.1 写入 API（Pepper 调用）

| 端点 | 方法 | 说明 |
|------|------|------|
| `/api/articles/batch` | POST | 批量写入当日短分析 |
| `/api/digest` | POST | 写入当日综述 |

### 9.2 读取 API（Webapp 调用）

| 端点 | 方法 | 说明 |
|------|------|------|
| `/api/articles/today` | GET | 获取今日文章 |
| `/api/articles/archive` | GET | 获取往期文章（分页，支持领域筛选） |
| `/api/domains` | GET | 获取领域配置 |

### 9.3 投票 API（H5 投票组件调用）

| 端点 | 方法 | 说明 |
|------|------|------|
| `/api/vote` | POST | 提交投票 |
| `/api/vote/result/:digest_id` | GET | 获取投票结果 |
| `/api/vote/trend/:domain` | GET | 获取某领域的历史趋势 |

### 9.4 公众号 API（Pepper 调用）

| 端点 | 方法 | 说明 |
|------|------|------|
| `/api/wechat/draft` | POST | 创建公众号草稿 |
| `/api/wechat/publish/:id` | POST | 发布草稿（需 DQ 确认） |

### 9.5 安全

- 写入 API 需要 API Key 认证（环境变量配置）
- 读取 API 完全公开
- 投票 API 有频率限制（防刷）

---

## 十、分阶段交付

### Phase 1: MVP（目标 1-2 周）

- [x] CloudBase 项目初始化 + 云数据库 + 云函数
- [ ] 数据模型建表（articles, digest, domains）
- [ ] 写入 API（Pepper → CloudBase）
- [ ] 读取 API（Webapp → CloudBase）
- [ ] Webapp 两个 Tab（今日 + 往期 + 领域筛选）
- [ ] Pepper 脚本改造（输出目标从 Telegram 改为 CloudBase API）
- [ ] Vercel 测试部署
- [ ] CloudBase 静态托管上线
- [ ] Telegram 通知降级

### Phase 2: 公众号 + 投票

- [ ] 微信公众号 API 接入
- [ ] 综述自动生成（Pepper 第二步）
- [ ] H5 投票组件开发 + CloudBase 托管
- [ ] 投票数据表（votes）+ 投票 API
- [ ] 公众号草稿自动创建
- [ ] 投票结果实时展示

### Phase 3: 趋势与增长

- [ ] Twikoo 评论系统接入
- [ ] Webapp 趋势图表页（投票历史可视化）
- [ ] 域名备案（可选，提升微信内 webapp 链接体验）
- [ ] 「时代情绪季报」自动生成
- [ ] 搜索功能

---

## 十一、从 Thoughts-hunter 迁移

### 11.1 复用清单

| 资产 | 处理方式 |
|------|----------|
| `CONTENT_SOURCES.json` | 直接复制，作为 RSS 源配置 |
| 领域定义（6 大频段） | 简化为单层，写入 domains 配置 |
| `wechat-publisher.js` 逻辑 | 参考重写为 CloudBase 云函数 |
| `daily-briefing.py` | 改造输出目标 |
| Railway 后端 + PostgreSQL | **下线** |
| React Native APP | **废弃** |
| CMS | **废弃** |
| 旧 webapp (纽约客风格 HTML) | 设计风格参考，代码不复用 |

### 11.2 旧 Repo 处理

- `Thoughts-hunter` README 加注「已迁移至 mind-our-times」
- 归档，不删除（保留历史参考）

---

## 十二、变更记录

| 日期 | 版本 | 变更 |
|------|------|------|
| 2026-02-04 | v1.0 | 初始版本，DQ 确认产品方向后编写 |

---

*本文件是 Mind Our Times 项目的唯一需求来源。*
